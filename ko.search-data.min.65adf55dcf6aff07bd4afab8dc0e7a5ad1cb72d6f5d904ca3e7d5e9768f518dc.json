[{"id":0,"href":"/posts/game-develop/common/game-data1/","title":"â˜ï¸ GoogleSheetsë¡œ GameData ê´€ë¦¬í•˜ê¸° (1)","section":"ğŸ“ Common","content":"ê²Œì„ ë°ì´í„°ë¥¼ Unity ì™¸ë¶€ì—ì„œ ìˆ˜ì •í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ìœ¼ë¡œ Google Spread Sheetsë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ë°ì´í„° íŒŒì¼ì„ Unity ì™¸ë¶€ì— ë‘ë©´ ë¹Œë“œ í›„ì—ë„ ë°ì´í„°ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆì–´ì„œ ìœ ì§€ë³´ìˆ˜ê°€ ì‰½ìŠµë‹ˆë‹¤.\nëª©ì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n[ëª©ì°¨]\nGoogle Spread Sheets ì¤€ë¹„ Unityì—ì„œ Google Spread Sheets ë¶ˆëŸ¬ì˜¤ê¸° ë°ì´í„° ì½”ë“œ ìƒì„± 1. Google Spread Sheets ì¤€ë¹„ # Google Spread Sheets APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ì„¸íŒ…í•´ë´…ì‹œë‹¤.\nì•„ë˜ ë§í¬ì— ì ‘ì†í•´ì„œ, ì—°ë™í•  êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.\nğŸ”— https://console.developers.google.com/\nìƒë‹¨ì˜ í”„ë¡œì íŠ¸ ì„ íƒ ì°½ì„ ì—´ì–´ì„œ ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•´ì¤ë‹ˆë‹¤.\nì´ í”„ë¡œì íŠ¸ì— ìš°ë¦¬ê°€ í•´ì¤„ ì¼ì€ OAuth í´ë¼ì´ì–¸íŠ¸ IDë¥¼ ìƒì„±í•˜ê³ , ê³ ìœ  í‚¤ë¥¼ ë°œê¸‰ë°›ëŠ” ê²ƒì…ë‹ˆë‹¤. OAuth ë™ì˜ í™”ë©´ íƒ­ì„ ëˆŒëŸ¬ì„œ ëŒ€ìƒì„ \u0026lsquo;ì™¸ë¶€\u0026rsquo;ë¡œ ì„¸íŒ…í•œ í›„ \u0026lsquo;ë§Œë“¤ê¸°\u0026rsquo; ë²„íŠ¼ì„ ëˆŒëŸ¬ì¤ë‹ˆë‹¤.\nëŒ€ìƒ íƒ­ì—ì„œ ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìë¡œ ë³¸ì¸ ì´ë©”ì¼ì„ ë“±ë¡í•´ì¤ë‹ˆë‹¤.\nì´ì œ í´ë¼ì´ì–¸íŠ¸ IDë¥¼ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜•ì€ \u0026lsquo;ë°ìŠ¤í¬í†± ì•±\u0026rsquo;ì„ ì„ íƒí•´ì¤ë‹ˆë‹¤.\nê·¸ëŸ¬ë©´ IDì™€ ë³´ì•ˆ ë¹„ë°€ë²ˆí˜¸ê°€ ìƒê¹ë‹ˆë‹¤. Unityì— ì—°ë™í•  ë•Œ í•„ìš”í•˜ë‹ˆ ë³µì‚¬í•´ë‘¡ì‹œë‹¤. ì°¸ê³ ë¡œ ë¹„ë°€ë²ˆí˜¸ëŠ” ì²˜ìŒ ìƒì„±í•œ í›„ ë‹¤ì‹œ ì°¾ì•„ë³¼ ìˆ˜ ì—†ìœ¼ë‹ˆ ë”°ë¡œ ë³µì‚¬í•´ì„œ ì €ì¥í•´ë‘ì–´ì•¼ í•©ë‹ˆë‹¤.\nê²€ìƒ‰ì°½ì—ì„œ Google Sheets APIë¥¼ ê²€ìƒ‰í•œ í›„, ì‚¬ìš© ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ëì´ ë‚©ë‹ˆë‹¤.\n2. Unityì—ì„œì˜ ì‚¬ìš© ë°©ë²• # ìœ ë‹ˆí‹°ì— Google Spread Sheetsë¥¼ ì—°ë™í•˜ëŠ” ë°©ë²•ì„ ê²€ìƒ‰í•˜ë©´ ì£¼ë¡œ GSTU(Google Sheets To Unity)ë¼ëŠ” ë¬´ë£Œ ì—ì…‹ì´ ë§ì´ ë‚˜ì˜µë‹ˆë‹¤.\nğŸ”— https://assetstore.unity.com/packages/tools/utilities/google-sheets-to-unity-73410\nì´ëŸ° ì¢‹ì€ ë¬´ë£Œ ì—ì…‹ì„ ê°€ì ¸ë‹¤ ì‚¬ìš©í•˜ëŠ” ê²ƒë„ ë‚˜ì˜ì§€ ì•Šê² ì§€ë§Œ, ì œê°€ ì›í•˜ëŠ” ê²ƒì€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ ë‚´ìš©ì„ ê°€ì ¸ë‹¤ê°€ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„° ì½”ë“œë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\nìƒˆë¡œìš´ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ë¥¼ ìƒì„±í•˜ê³ , ë‹¤ìŒê³¼ ê°™ì´ ë°ì´í„°ì˜ ì²« í–‰ì—ëŠ” data type, ë‘ë²ˆì§¸ í–‰ì—ëŠ” í•„ë“œ ì´ë¦„ì„ ì ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\nint string float enum Id Name Hp ColorType 1 Knight 100 Red 2 Archer 80 Blue 3 Mage 60 Green ì´ëŸ° ë°ì´í„°ë¥¼ ì…ë ¥í•œ í›„ ìœ ë‹ˆí‹° ì—ë””í„°ì—ì„œ ë”¸ê¹ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´\npublic class TestData { public int Id { get; private set; } public string Name { get; private set; } public float Hp { get; private set; } public ColorType ColorType { get; private set; } public TestData(int id, string name, float hp, ColorType colorType) { Id = id; Name = name; Hp = hp; ColorType = colorType; } } ì´ë ‡ê²Œ ë°ì´í„° í´ë˜ìŠ¤ê°€ ìƒì„±ë©ë‹ˆë‹¤.\nêµ¬ì¡°ëŠ” ì´ë ‡ìŠµë‹ˆë‹¤.\nGoogleSheetConfig: ScriptableObject ì…ë‹ˆë‹¤. ì—¬ëŸ¬ ê°’ì„ ìºì‹±í•˜ëŠ” ìš©ë„ì…ë‹ˆë‹¤. GoogleSheetMenu: ìœ ë‹ˆí‹°ì— ë©”ë‰´ë¥¼ í‘œì‹œí•´ì¤ë‹ˆë‹¤. GoogleSheetManager: ìœ íš¨í•œ í† í°ìœ¼ë¡œ ì‹œíŠ¸ ëª©ë¡ì„ ë°›ì•„ì˜µë‹ˆë‹¤. DataCodeGenerator: ì‹œíŠ¸ ëª©ë¡ì„ ë°›ì•„ì„œ ë°ì´í„° ì½”ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 1) GoogleSheetsConfig ìƒì„± # ìœ„ì—ì„œ ìƒì„±í•œ í´ë¼ì´ì–¸íŠ¸ ID, ë³´ì•ˆ ë¹„ë°€ë²ˆí˜¸, ì—°ë™í•  ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ ë§í¬ë¥¼ ì…ë ¥í•  config íŒŒì¼ì…ë‹ˆë‹¤.\nGoogleSheetsConfig [CreateAssetMenu(menuName = \u0026#34;SpreadSheetConfig\u0026#34;)] public class GoogleSheetConfig : ScriptableObject { [SerializeField] private string _clientId; [SerializeField] private string _clientSecretNumber; [SerializeField] private string _googleSheetId; [SerializeField] private int _portNumber = 8080; [SerializeField] private float _cancelTimeSeconds = 30f; [SerializeField, HideInInspector] private OAuthToken _oAuthToken; public const string FilePath = \u0026#34;Assets/1_Script/Common/GoogleSpreadSheet/GoogleSheetConfig.asset\u0026#34;; public OAuthToken OAuthTokenCache =\u0026gt; _oAuthToken; public (string Id, string SecretNumber) ClientInfo =\u0026gt; (_clientId, _clientSecretNumber); public string GoogleSheetId =\u0026gt; _googleSheetId; public string RedirectUrl =\u0026gt; $\u0026#34;http://localhost:{_portNumber.ToString()}/\u0026#34;; public bool IsAccessTokenValid =\u0026gt; OAuthTokenCache != null \u0026amp;\u0026amp; !string.IsNullOrEmpty(OAuthTokenCache.AccessToken) \u0026amp;\u0026amp; OAuthTokenCache.NextRefreshTime \u0026gt; DateTime.Now.Ticks; public bool HasRefreshToken =\u0026gt; OAuthTokenCache != null \u0026amp;\u0026amp; !string.IsNullOrEmpty(OAuthTokenCache.RefreshToken); public float CancelTimeSeconds =\u0026gt; _cancelTimeSeconds; public void SetOAuthToken(OAuthToken token) { _oAuthToken = token; token.NextRefreshTime = DateTime.Now.AddSeconds(token.ExpiresIn).Ticks; #if UNITY_EDITOR EditorUtility.SetDirty(this); AssetDatabase.SaveAssets(); #endif } } 2) GoogleSheetMenu # UnityEditor.MenuItemìœ¼ë¡œ ë©”ë‰´ë¥¼ ë“±ë¡í•´ Unity Editor ìƒë‹¨ì˜ íƒ­ì„ í´ë¦­í•˜ë©´ ì½”ë“œê°€ ì‹¤í–‰ë˜ë„ë¡ í•©ë‹ˆë‹¤.\nGoogleSheetMenu [MenuItem(\u0026#34;Google Sheet/Generate Data Code\u0026#34;)] public static void GenerateDataCode() { GenerateDataCodeAsync().Forget(); return; async UniTask GenerateDataCodeAsync() { var config = AssetDatabase.LoadAssetAtPath\u0026lt;GoogleSheetConfig\u0026gt;(GoogleSheetConfig.FilePath); if (!config) { Debug.LogError(\u0026#34;SpreadSheetsConfig not found\u0026#34;); return; } var sheets = await GoogleSheetManager.GetSheetsAsync(config); await GoogleSheetCodeGenerator.GenerateAll(config, sheets); } } 3) GoogleSheetManager # DataClass [Serializable] public class OAuthToken { [JsonProperty(\u0026#34;access_token\u0026#34;)] public string AccessToken { get; set; } [JsonProperty(\u0026#34;refresh_token\u0026#34;)] public string RefreshToken { get; set; } [JsonProperty(\u0026#34;token_type\u0026#34;)] public string TokenType { get; set; } [JsonProperty(\u0026#34;expires_in\u0026#34;)] public int ExpiresIn { get; set; } public long NextRefreshTime; } [Serializable] public class GoogleSheetInfoResponse { [JsonProperty(\u0026#34;sheets\u0026#34;)] public List\u0026lt;SheetEntry\u0026gt; Sheets { get; set; } } [Serializable] public class SheetEntry { [JsonProperty(\u0026#34;properties\u0026#34;)] public SheetProperties Properties { get; set; } } [Serializable] public class SheetProperties { [JsonProperty(\u0026#34;sheetId\u0026#34;)] public int SheetId { get; set; } [JsonProperty(\u0026#34;title\u0026#34;)] public string SheetName { get; set; } [JsonProperty(\u0026#34;index\u0026#34;)] public int Index { get; set; } [JsonProperty(\u0026#34;sheetType\u0026#34;)] public string SheetType { get; set; } [JsonProperty(\u0026#34;gridProperties\u0026#34;)] public GridProperties GridProperties { get; set; } } [Serializable] public class GridProperties { [JsonProperty(\u0026#34;rowCount\u0026#34;)] public int RowCount { get; set; } [JsonProperty(\u0026#34;columnCount\u0026#34;)] public int ColumnCount { get; set; } } public class SheetValueResponse { [JsonProperty(\u0026#34;values\u0026#34;)] public List\u0026lt;List\u0026lt;string\u0026gt;\u0026gt; Values { get; set; } } public struct SheetInfo { public string SheetName { get; internal set; } public string[] ColumnTypes { get; internal set; } public string[] ColumnNames { get; internal set; } public Dictionary\u0026lt;int, List\u0026lt;string\u0026gt;\u0026gt; EnumList { get; internal set; } } GetSheetsAsync() í•¨ìˆ˜ì˜ ë‚´ìš©ì„ ì´ë ‡ìŠµë‹ˆë‹¤.\nGoogleSheetManager.GetSheetsAsync() public static async UniTask\u0026lt;GoogleSheetInfoResponse\u0026gt; GetSheetsAsync(GoogleSheetConfig config) { if (!config.IsAccessTokenValid) { if (config.HasRefreshToken) { await RefreshAccessTokenAsync(config); } else { Debug.Log(\u0026#34;ğŸŒ Tokenì´ ì—†ìŒ =\u0026gt; ë¸Œë¼ìš°ì € ì¸ì¦ ëŒ€ê¸° ì¤‘...\u0026#34;); var isSuccess = await StartOAuth(config); if (!isSuccess) { Debug.Log(\u0026#34;âŒ ë¸Œë¼ìš°ì € ì¸ì¦ ì‹¤íŒ¨\u0026#34;); return null; } } } var googleSheetInfo = await FetchSheetListAsync(config); return googleSheetInfo; } AccessTokenì´ ì—†ì„ ê²½ìš° StartOAuth() í•¨ìˆ˜ë¥¼ í†µí•´ ìƒˆë¡œ ì¸ì¦ í›„ í† í°ì„ ë°›ì•„ì˜µë‹ˆë‹¤. ì´ ë•Œ ì¸ì¦ì„ ì—¬ëŸ¬ë²ˆ í•˜ì§€ ì•Šê¸° ìœ„í•´ RefreshTokenë„ í•¨ê»˜ ì €ì¥í•©ë‹ˆë‹¤.\nGoogleSheetManager.StartOAuth() private static async UniTask\u0026lt;bool\u0026gt; StartOAuth(GoogleSheetConfig config) { try { _cts?.Cancel(); _cts = new CancellationTokenSource(); _cts.CancelAfter(TimeSpan.FromSeconds(config.CancelTimeSeconds)); // OAuth ì¸ì¦ URL ì˜¤í”ˆ var url = GetBuildOAuthUrl(); Application.OpenURL(url); // Unity ë¡œì»¬ ì„œë²„(HttpListener)ë¡œ ì¸ì¦ ì½”ë“œ ë°›ì•„ì˜´ _httpListener = new HttpListener(); _httpListener.Prefixes.Add(config.RedirectUrl); _httpListener.Start(); _httpListenerContext = await _httpListener.GetContextAsync().AsUniTask().AttachExternalCancellation(_cts.Token); var code = _httpListenerContext.Request.QueryString[\u0026#34;code\u0026#34;]; const string responseHtml = \u0026#34;\u0026lt;html\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h2\u0026gt;Authentication complete. You can now return to Unity.\u0026lt;/h2\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;; var buffer = Encoding.UTF8.GetBytes(responseHtml); _httpListenerContext.Response.ContentLength64 = buffer.Length; await _httpListenerContext.Response.OutputStream.WriteAsync(buffer, 0, buffer.Length, _cts.Token); // í† í° ìš”ì²­ var form = new WWWForm(); form.AddField(\u0026#34;code\u0026#34;, code); form.AddField(\u0026#34;client_id\u0026#34;, config.ClientInfo.Id); form.AddField(\u0026#34;client_secret\u0026#34;, config.ClientInfo.SecretNumber); form.AddField(\u0026#34;redirect_uri\u0026#34;, config.RedirectUrl); form.AddField(\u0026#34;grant_type\u0026#34;, \u0026#34;authorization_code\u0026#34;); var request = UnityWebRequest.Post(TokenEndpoint, form); await request.SendWebRequest().ToUniTask(cancellationToken: _cts.Token); if (request.result != UnityWebRequest.Result.Success) { Debug.LogError(\u0026#34;âŒ Token ìš”ì²­ ì‹¤íŒ¨: \u0026#34; + request.error); return false; } var token = JsonConvert.DeserializeObject\u0026lt;OAuthToken\u0026gt;(request.downloadHandler.text); config.SetOAuthToken(token); Debug.Log(\u0026#34;âœ… Access Token ë°œê¸‰ ì„±ê³µ\u0026#34;); return true; } catch (OperationCanceledException) { Debug.LogError(\u0026#34;â±ï¸ ì¸ì¦ ì‹œê°„ ì´ˆê³¼\u0026#34;); return false; } catch (Exception e) { Debug.LogError(e); return false; } finally { _httpListenerContext?.Response.OutputStream?.Close(); _httpListener.Stop(); } string GetBuildOAuthUrl() { return new StringBuilder(Endpoint) .Append($\u0026#34;?client_id={config.ClientInfo.Id}\u0026#34;) .Append($\u0026#34;\u0026amp;redirect_uri={config.RedirectUrl}\u0026#34;) .Append(\u0026#34;\u0026amp;response_type=code\u0026#34;) .Append(\u0026#34;\u0026amp;scope=https://www.googleapis.com/auth/spreadsheets.readonly\u0026#34;) .Append(\u0026#34;\u0026amp;access_type=offline\u0026amp;prompt=consent\u0026#34;) .ToString(); } } AccessTokenì€ ìˆëŠ”ë°, ë§Œë£Œ ê¸°í•œì´ ì§€ë‚¬ì„ ê²½ìš°ì—” RefreshAccessTokenAsync()í•¨ìˆ˜ë¥¼ í†µí•´ RefreshTokenìœ¼ë¡œ ìƒˆë¡œ AccessTokenì„ ë°›ì•„ì˜µë‹ˆë‹¤.\nGoogleSheetManager.RefreshAccessTokenAsync() private static async UniTask\u0026lt;bool\u0026gt; RefreshAccessTokenAsync(GoogleSheetConfig config) { var form = new WWWForm(); form.AddField(\u0026#34;client_id\u0026#34;, config.ClientInfo.Id); form.AddField(\u0026#34;client_secret\u0026#34;, config.ClientInfo.SecretNumber); form.AddField(\u0026#34;refresh_token\u0026#34;, config.OAuthTokenCache.RefreshToken); form.AddField(\u0026#34;grant_type\u0026#34;, \u0026#34;refresh_token\u0026#34;); var request = UnityWebRequest.Post(TokenEndpoint, form); await request.SendWebRequest().ToUniTask(); if (request.result != UnityWebRequest.Result.Success) { Debug.LogError(\u0026#34;âŒ Refresh í† í° ìš”ì²­ ì‹¤íŒ¨: \u0026#34; + request.error); return false; } var token = JsonConvert.DeserializeObject\u0026lt;OAuthToken\u0026gt;(request.downloadHandler.text); config.SetOAuthToken(token); Debug.Log(\u0026#34;ğŸ” AccessToken ê°±ì‹  ì™„ë£Œ\u0026#34;); return true; } FetchSheetListAsync() í•¨ìˆ˜ì—ì„œëŠ” ì‹œíŠ¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.\nGoogleSheetManager.FetchSheetListAsync() private static async UniTask\u0026lt;GoogleSheetInfoResponse\u0026gt; FetchSheetListAsync(GoogleSheetConfig config) { if (string.IsNullOrEmpty(config.GoogleSheetId)) { Debug.LogError(\u0026#34;âŒ Spreadsheet Idê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\u0026#34;); return null; } var url = GetGoogleSheetUrl(config.GoogleSheetId); var request = UnityWebRequest.Get(url); request.SetRequestHeader(\u0026#34;Authorization\u0026#34;, $\u0026#34;Bearer {config.OAuthTokenCache.AccessToken}\u0026#34;); await request.SendWebRequest().ToUniTask(); if (request.result != UnityWebRequest.Result.Success) { Debug.LogError($\u0026#34;âŒ ì‹œíŠ¸ ëª©ë¡ ìš”ì²­ ì‹¤íŒ¨: {request.error}\u0026#34;); return null; } Debug.Log(\u0026#34;âœ… ì‹œíŠ¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì„±ê³µ\u0026#34;); var sheetInfoJson = request.downloadHandler.text; var sheetInfo = JsonConvert.DeserializeObject\u0026lt;GoogleSheetInfoResponse\u0026gt;(sheetInfoJson); return sheetInfo; } 3. ë°ì´í„° ì½”ë“œ ìƒì„± # ì´ì œ GoogleSheetManager.GetSheetsAsync()ë¡œ ë°›ì•„ì˜¨ GoogleSheetInfoResponseë¡œ ë°ì´í„° ì½”ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. GoogleSheetInfoResponseë¡œ ì—ëŠ” ê° ì‹œíŠ¸ì˜ ì´ë¦„ê³¼ ê°™ì€ ì •ë³´ë§Œ ìˆì„ ë¿ ì‹œíŠ¸ì˜ ëª¨ë“  í–‰ê³¼ ì—´ì— ëŒ€í•œ ë‚´ìš©ì´ ë‹´ê¸´ ê²ƒì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ê° ì‹œíŠ¸ì˜ ë°ì´í„°ë¥¼ ìƒˆë¡œ ë¡œë“œí•´ì™€ì•¼ í•©ë‹ˆë‹¤.\nGoogleSheetInfoResponse.Sheets ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©° Properties.SheetNameìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¡œë“œí•´ì˜µë‹ˆë‹¤.\nLoadGoogleSheetsData() public static async UniTask\u0026lt;SheetValueResponse\u0026gt; LoadGoogleSheetsData(GoogleSheetConfig config, string sheetName) { var url = GetSheetValueUrl(config.GoogleSheetId, sheetName); var request = UnityWebRequest.Get(url); request.SetRequestHeader(\u0026#34;Authorization\u0026#34;, $\u0026#34;Bearer {config.OAuthTokenCache.AccessToken}\u0026#34;); await request.SendWebRequest().ToUniTask(); return JsonConvert.DeserializeObject\u0026lt;SheetValueResponse\u0026gt;(request.downloadHandler.text); } ê·¸ ë‹¤ìŒ ë¡œë“œí•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê¸° í¸í•˜ë„ë¡ SheetInfoë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.\nì•ì˜ ì˜ˆì‹œ ë°ì´í„°ì—ì„œ ì²«ë²ˆì§¸ í–‰ì€ ë°ì´í„°ì˜ íƒ€ì…, ë‘ë²ˆì§¸ í–‰ì€ ë°ì´í„°ì˜ í•„ë“œ ì´ë¦„ì´ ë“¤ì–´ê°”ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ columnTypes í•„ë“œì—ëŠ” sheetValue.Values[0]ë¥¼, columnNames í•„ë“œì—ëŠ” sheetValue.Values[1]ë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.\nGetDataForGenerate() private static SheetInfo GetDataForGenerate(string sheetName, SheetValueResponse sheetValue) { if (sheetValue.Values.Count \u0026lt; 2) { Debug.LogWarning($\u0026#34;âš ï¸ ì‹œíŠ¸ {sheetName}ì˜ ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤ (2ì¤„ ì´ìƒ í•„ìš”)\u0026#34;); return default; } var columnTypes = sheetValue.Values[0].ToArray(); var columnNames = sheetValue.Values[1].ToArray(); var enumDic = new Dictionary\u0026lt;int, List\u0026lt;string\u0026gt;\u0026gt;(); for (var j = 0; j \u0026lt; columnTypes.Length; j++) { if (columnTypes[j].ToLower() != TypeEnum) continue; enumDic.Add(j, new List\u0026lt;string\u0026gt;()); } for (var j = 2; j \u0026lt; sheetValue.Values.Count; j++) { var columns = sheetValue.Values[j].ToArray(); for (var k = 0; k \u0026lt; columns.Length; k++) { if (!enumDic.TryGetValue(k, out var enumList)) continue; if (enumList.Contains(columns[k])) continue; enumDic[k].Add(columns[k]); } } return new SheetInfo { SheetName = sheetName, ColumnNames = columnNames, ColumnTypes = columnTypes, EnumList = enumDic, }; } ì´ì œ SheetInfo Listë¥¼ ê°€ì§€ê³  StringBuilder.AppendLine()ìœ¼ë¡œ ìƒì„±í•  ì½”ë“œë¥¼ ì°¨ê³¡ì°¨ê³¡ ìŒ“ì•„ ì €ì¥í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.\nMakeDataClass() private static StringBuilder MakeDataClass(List\u0026lt;SheetInfo\u0026gt; loadedDataList) { var sb = new StringBuilder(); sb.AppendLine($\u0026#34;namespace {GoogleSheetCodeGenerator.GeneratedGameDataNameSpace}\u0026#34;); sb.AppendLine(\u0026#34;{\u0026#34;); foreach (var loadedData in loadedDataList) { sb.AppendIndentedLine($\u0026#34;public class {loadedData.SheetName}\u0026#34;, 1); sb.AppendIndentedLine(\u0026#34;{\u0026#34;, 1); for (var i = 0; i \u0026lt; loadedData.ColumnNames.Length; i++) { var columnName = loadedData.ColumnNames[i]; if (loadedData.ColumnTypes[i].ToLower() == GoogleSheetCodeGenerator.TypeEnum) { sb.AppendIndentedLine($\u0026#34;public {columnName} {columnName}\u0026#34; + \u0026#34; { get; private set; }\u0026#34;, 2); } else { var columnType = GoogleSheetCodeGenerator.StringToTypes[loadedData.ColumnTypes[i]]; sb.AppendIndentedLine($\u0026#34;public {columnType} {columnName}\u0026#34; + \u0026#34; { get; private set; }\u0026#34;, 2); } } sb.AppendLine(); var paramList = GoogleSheetCodeGenerator.MakeParameters(loadedData.ColumnTypes, loadedData.ColumnNames); sb.AppendIndentedLine($\u0026#34;public {loadedData.SheetName}({paramList})\u0026#34;, 2); sb.AppendIndentedLine(\u0026#34;{\u0026#34;, 2); foreach (var columnName in loadedData.ColumnNames) { sb.AppendIndentedLine($\u0026#34;{columnName} = {columnName.FirstCharacterToLower()};\u0026#34;, 3); } sb.AppendIndentedLine(\u0026#34;}\u0026#34;, 2); sb.AppendIndentedLine(\u0026#34;}\u0026#34;, 1); } sb.AppendLine(\u0026#34;}\u0026#34;); return sb; } WriteGameDataToFileAsync() public static async UniTask WriteGameDataToFileAsync(string filePath, StringBuilder contents) { var directoryName = Path.GetDirectoryName(filePath); if (!string.IsNullOrEmpty(directoryName) \u0026amp;\u0026amp; !Directory.Exists(directoryName)) { Directory.CreateDirectory(directoryName); } await File.WriteAllTextAsync(filePath, contents.ToString(), UTF8NoBom); } ì—¬ê¸°ê¹Œì§€ ë§ˆì¹˜ë©´ ìœ ë‹ˆí‹° ì—ë””í„°ì˜ ìƒë‹¨ Google Sheet íƒ­ì„ í†µí•´ ë°ì´í„° ì½”ë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì´ì œ ì‹¤ì œ í”Œë ˆì´ ì‹œ ì‹¤ì œ ë°ì´í„°ë¥¼ ë°›ì•„ì™€ì„œ ì´ ë°ì´í„° í´ë˜ìŠ¤ì— ì €ì¥í•´ì¤˜ì•¼ê² ì£ . ì´í›„ì˜ ë‚´ìš©ì€ ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë¤„ë³´ê² ìŠµë‹ˆë‹¤.\n"}]